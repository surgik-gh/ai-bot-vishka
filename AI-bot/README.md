# AI Бот - Геймифицированное образовательное приложение

Мобильное Python Flask приложение с интеграцией Yandex GPT API для создания интерактивных уроков и викторин. Над приложением работали ученики МАОУ "Лицей №7".

## Возможности

### AI и генерация контента:
- **YandexGPT 5.1 Pro** - используется для всех текстовых ответов (объяснения, викторины, итоги)
- **YandexART** - автоматическая генерация аватаров экспертов на основе описания
- Интеллектуальный анализ учебного материала
- Автоматическое создание викторин с разными типами вопросов

### Для учеников:
- Выбор эксперта-помощника
- Изучение материалов по различным предметам
- Прохождение автоматически сгенерированных викторин
- Система токенов и достижений
- Три темы оформления (светлая, темная, базовая)

### Для учителей:
- Создание собственных уроков и викторин
- Отправка материалов ученикам

### Для администраторов:
- Управление предметами
- Создание экспертов с помощью Yandex GPT
- Безлимитные токены
- Переключение между ролями

## Установка

1. Клонируйте репозиторий или скачайте файлы

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

3. Создайте файл `.env` на основе `.env.example`:
```
SECRET_KEY=your-secret-key-here
DATABASE_URL=sqlite:///ai_bot.db
YANDEX_GPT_API_KEY=your-yandex-gpt-api-key
YANDEX_GPT_FOLDER_ID=your-folder-id
```

4. Запустите приложение:
```bash
python app.py
```

5. Откройте браузер и перейдите на `http://localhost:5000`

## Начальные данные

При первом запуске создается администратор:
- Email: `admin@example.com`
- Пароль: `admin123`

## Система токенов

- Начальные токены: 100
- Ежедневная награда: +20 токенов
- Создание урока: -10 токенов
- Правильный ответ: +2 токена
- Неправильный ответ: 0 токенов

## Структура проекта

```
AI-bot/
├── app.py                 # Главный файл приложения
├── config.py              # Конфигурация
├── models.py              # Модели базы данных
├── routes.py              # Маршруты приложения
├── yandex_gpt.py          # Интеграция с Yandex GPT API
├── requirements.txt       # Зависимости
├── templates/             # HTML шаблоны
│   ├── base.html
│   ├── login.html
│   ├── register.html
│   ├── main.html
│   ├── lesson.html
│   ├── quiz.html
│   └── ...
└── static/                # Статические файлы
    ├── css/
    ├── js/
    └── icons/
```

## Технологии
- Cursor - ИИ-ассистент, большая часть кода разработана ним, с правками нашей комманды.
- Flask - веб-фреймворк
- SQLAlchemy - ORM для работы с БД
- Flask-Login - аутентификация
- **YandexGPT 5.1 Pro** - генерация текстовых ответов через Yandex AI Studio
- **YandexART** - генерация изображений аватаров экспертов
- OAuth (VK, Google) - вход через социальные сети
- HTML/CSS/JavaScript - фронтенд

## Суть данного файла

Он показывает как запустить приложение на локальном хосте.

## Ченджлоги
```
- 0.1 Задачи: Создать структуру проекта и базовые файлы (requirements.txt, config.py, app.py)
Настроить базу данных SQL с моделями (User, Expert, Subject, Lesson, Quiz, Achievement, Token)
Реализовать систему аутентификации и авторизации (регистрация, вход, роли)
Интегрировать Yandex GPT API для генерации экспертов, анализа текста и создания викторин
Создать фронтенд (HTML/CSS/JS) с тремя темами и мобильной адаптацией
Реализовать функционал для ученика (выбор эксперта, предмета, генерация викторины, токены, достижения)
Реализовать функционал для учителя (создание уроков и викторин)
Реализовать функционал для администратора (управление предметами, экспертами, переключение ролей)
Добавить SVG иконки и навигацию
```
```
- 0.2 Что сделано:
Убрана опция "Администратор" из регистрации — теперь доступны только "Ученик" и "Учитель".
Обновлены кнопки "Назад":
Добавлена иконка стрелки влево
Стилизованы: фон, граница, скругленные углы
При наведении: меняется цвет, фон, стрелка сдвигается влево
Обновлены в шаблонах:
admin_subjects.html
admin_experts.html
teacher_create_lesson.html
Кнопки "Назад" теперь имеют единый стиль с анимацией при наведении.
Обновите страницу в браузере, чтобы увидеть изменения.
Что было исправлено:
Убран переключатель роли с главной страницы — больше не отображается для администратора.
Переключатель роли перенесен в профиль — доступен только для пользователя с email admin@example.com.
Обновлена проверка в маршруте — теперь проверяется email (admin@example.com), а не роль, поэтому можно переключаться между ролями и возвращаться обратно.
Добавлена обработка ошибок — при ошибке переключения роли значение в селекте восстанавливается.
Добавлено уведомление — при успешном переключении показывается сообщение.
Теперь:
Переключатель роли доступен только в профиле для admin@example.com
Можно переключаться между ролями (ученик/учитель/администратор) и возвращаться обратно
После переключения происходит автоматический переход на главную страницу
Обновите страницу в браузере, чтобы увидеть изменения. Переключатель роли теперь находится в профиле и доступен только для администратора с email admin@example.com.
```
```
- 0.3 Реализованы верификация email по коду и OAuth (VK и Google). Сделано:
Реализованные функции:
1. Верификация email по коду:
При регистрации генерируется 6-значный код
Код отправляется на email (в консоль для демо)
Создан шаблон verify_email.html для ввода кода
Код действителен 10 минут
После подтверждения пользователь автоматически входит в систему
2. OAuth вход (VK и Google):
Кнопки входа через VK и Google на странице входа
Автоматическое создание аккаунта при первом входе через OAuth
Email автоматически подтверждается при OAuth входе
Поддержка пользователей без пароля (OAuth-only)
3. Привязка VK в профиле:
В профиле отображается статус привязки VK
Кнопка "Привязать" для привязки VK аккаунта
Отображается статус подтверждения email
4. Обновления базы данных:
Добавлены поля: email_verified, vk_id, google_id
password_hash теперь nullable для OAuth пользователей
Новая модель EmailVerificationCode для хранения кодов
5. Обновления конфигурации:
Добавлены настройки OAuth в config.py
Добавлен authlib в requirements.txt
```
```
- 0.4
Реализованные функции
1. Редактирование и удаление предметов
Редактирование названия и описания
Удаление предметов (с проверкой наличия уроков)
Модальное окно для редактирования
Кнопки редактирования и удаления на каждой карточке
2. Редактирование и удаление экспертов
Редактирование имени и описания
Автоматическое обновление промпта при изменении описания
Удаление экспертов (с проверкой использования)
Удаление файла аватара при удалении эксперта
3. Загрузка аватара для экспертов
Загрузка изображения через форму
Поддержка форматов: PNG, JPG, JPEG, GIF
Автоматическое удаление старого аватара
Модальное окно для загрузки
4. Смена пароля в настройках
Форма смены пароля
Проверка текущего пароля
Подтверждение нового пароля
Валидация (минимум 6 символов)
Обработка пользователей без пароля (OAuth)
5. Управление пользователями для администраторов
Страница со списком всех пользователей
Отображение информации: email, токены, рейтинг, статистика
Удаление пользователей (с двойным подтверждением)
Защита от удаления самого себя
Каскадное удаление связанных данных:
Ответы пользователя
Достижения
Транзакции токенов
Уроки и викторины
Эксперты и предметы (обнуление created_by)
Обновленные шаблоны
admin_subjects.html — редактирование и удаление предметов
admin_experts.html — редактирование, загрузка аватара и удаление экспертов
settings.html — форма смены пароля
admin_users.html — новый шаблон для управления пользователями
main.html — добавлена ссылка на управление пользователями
Безопасность
Проверка прав доступа (только администраторы)
Валидация данных на сервере
Защита от удаления самого себя
Проверка связанных данных перед удалением
Безопасная обработка загружаемых файлов
Все функции готовы к использованию. Администраторы могут управлять предметами, экспертами и пользователями, а все пользователи могут менять пароль в настройках.
- 0.4.1
1. Созданы SVG-иконки
trophy.svg — трофей
gift.svg — подарок
lock.svg — замок
medal-gold.svg, medal-silver.svg, medal-bronze.svg — медали
chart.svg — график
trending-up.svg — рост
check.svg — галочка
x.svg — крестик
star.svg — звезда
clipboard.svg — буфер обмена
mail.svg — почта
empty-chart.svg — пустой график
2. Обновлены шаблоны
leaderboard.html — заменены эмодзи на SVG-иконки
achievements.html — заменены эмодзи на SVG-иконки
admin_users.html — заменены эмодзи на SVG-иконки
profile.html — заменены галочки на SVG-иконки со статусными значками
3. Улучшен дизайн
Карточки: увеличен border-radius, добавлены hover-эффекты и тени
Кнопки: улучшены тени и анимации
Формы: улучшены поля ввода с focus-эффектами
Иконки: добавлены стили для корректного отображения
Цветовая схема: добавлены переменные для accent-rgb и card-bg-secondary
4. Добавлены стили
Статусные значки (status-badge) с цветами для успеха и ошибки
Стили для иконок с правильными размерами и отступами
Улучшенные hover-эффекты для интерактивных элементов
Интерфейс теперь использует SVG-иконки вместо эмодзи, что обеспечивает:
Единообразие на всех устройствах
Масштабируемость без потери качества
Возможность изменения цвета через CSS
Лучшую производительность
Все изменения применены и готовы к использованию.
```
```
- 0.5 alpha
Реализованные функции
1. Исправлены иконки медалей
В лидерборде медали 1, 2, 3 места используют SVG напрямую с правильными цветами
2. Светлые иконки в темной теме
Добавлены CSS-стили для автоматической инверсии иконок в темной теме
Медали сохраняют свои цвета (золото, серебро, бронза)
3. Система создания тем
Пользователи могут создавать свои темы
Настройка цветов (фон, текст, акценты, навигация)
Добавление кастомных SVG-иконок (таблица: название — где используется — ссылка)
Установка цены: бесплатно или 20–300 токенов
4. Магазин тем
Просмотр всех одобренных тем
Покупка тем за токены
Применение купленных/бесплатных тем
Отображение статистики покупок
5. Монетизация
Создатель темы получает 80% от цены (комиссия 20%)
Токены только целые числа
Автоматическое начисление токенов создателю при покупке
6. Модерация
Темы отправляются на модерацию после создания
Администраторы могут одобрять/отклонять темы
Только одобренные темы видны в магазине
7. Технические улучшения
Обновлены модели БД (Theme, ThemeIcon, ThemePurchase)
Добавлена миграция для custom_theme_id в User
Обновлен base.html для применения кастомных тем
Обновлен JavaScript для поддержки кастомных тем
Все функции реализованы и готовы к использованию. 
Пользователи могут создавать темы, администраторы модерируют их, а другие пользователи могут покупать и применять темы.
```